import { APP_VIEWS } from '../constants.js';
import { escapeHtml } from '../utils/html.js';

// Plugin version - should match PHP version
const PLUGIN_VERSION = '0.4.3';

const BRAND_ICONS = {
    mark: '<svg xmlns="http://www.w3.org/2000/svg" width="220" height="57" viewBox="0 0 150 30" fill="none"><path d="M35.2905 19.2654V11.4514C35.2803 10.8307 35.4467 10.22 35.7705 9.69035C36.0943 9.16949 36.5523 8.74534 37.0965 8.46235C37.6895 8.15515 38.3497 8.00049 39.0175 8.01235H43.4715V10.7294H39.5495C39.346 10.7242 39.1488 10.8 39.0011 10.94C38.8534 11.08 38.7672 11.2729 38.7615 11.4764V12.7574H42.9505V15.4024H38.7505V17.5804L35.2905 19.2654Z" fill="#1C134F"/><path d="M48.8369 19.474C48.0476 19.4883 47.266 19.317 46.5549 18.974C45.9342 18.6764 45.4063 18.2152 45.0279 17.64C44.6602 17.0676 44.4699 16.3993 44.4809 15.719V10.933H47.5509V15.533C47.5522 15.7292 47.602 15.9219 47.6959 16.094C47.7946 16.2778 47.9424 16.4305 48.1229 16.535C48.3202 16.6503 48.5455 16.7088 48.7739 16.704C48.9879 16.7111 49.1994 16.6575 49.3842 16.5494C49.5689 16.4412 49.7193 16.283 49.8179 16.093C49.9119 15.9206 49.9618 15.7275 49.9629 15.531V10.931H53.0489V15.731C53.0605 16.4058 52.8854 17.0706 52.5429 17.652C52.1936 18.2252 51.6892 18.6877 51.0879 18.986C50.3878 19.3263 49.616 19.4927 48.8379 19.471L48.8369 19.474ZM47.3489 9.56105L48.8379 7.37305H51.3189L49.8299 9.56105H47.3489Z" fill="#1C134F"/><path d="M58.5928 19.474C57.8035 19.4882 57.0219 19.317 56.3108 18.974C55.6901 18.6763 55.1622 18.2151 54.7838 17.64C54.4161 17.0676 54.2258 16.3993 54.2368 15.719V10.933H57.3068V15.533C57.308 15.7292 57.3578 15.9219 57.4518 16.094C57.5501 16.278 57.6981 16.4308 57.8788 16.535C58.0761 16.6503 58.3013 16.7088 58.5298 16.704C58.7439 16.7113 58.9557 16.6578 59.1406 16.5496C59.3256 16.4415 59.4761 16.2832 59.5748 16.093C59.6681 15.9207 59.7176 15.728 59.7188 15.532V10.932H62.8048V15.732C62.8164 16.4068 62.6413 17.0716 62.2988 17.653C61.9497 18.226 61.4456 18.6885 60.8448 18.987C60.1444 19.3276 59.3722 19.4939 58.5938 19.472L58.5928 19.474ZM57.1038 9.56105L58.5928 7.37305H61.0738L59.5848 9.56105H57.1038Z" fill="#1C134F"/><path d="M64.0088 19.2637V8.01366H68.7828C69.8512 7.98698 70.9085 8.23598 71.8528 8.73666C72.6992 9.19707 73.3986 9.88679 73.8708 10.7267C74.3407 11.6243 74.5862 12.6224 74.5862 13.6357C74.5862 14.6489 74.3407 15.647 73.8708 16.5447C73.3997 17.3857 72.701 18.0769 71.8548 18.5387C70.9104 19.0391 69.8532 19.2881 68.7848 19.2617L64.0088 19.2637ZM67.4818 16.5457H68.5908C69.043 16.5535 69.4883 16.434 69.8758 16.2007C70.2606 15.9595 70.5676 15.6122 70.7598 15.2007C70.9838 14.7122 71.0933 14.1789 71.0798 13.6417C71.0939 13.1079 70.9844 12.5781 70.7598 12.0937C70.565 11.6839 70.2586 11.3373 69.8758 11.0937C69.4902 10.8551 69.0441 10.7326 68.5908 10.7407H67.4828L67.4818 16.5457Z" fill="#1C134F"/><path d="M80.0608 19.4573C79.2643 19.4666 78.4778 19.2794 77.7708 18.9123C77.0914 18.5588 76.5198 18.029 76.1158 17.3783C75.7113 16.6907 75.498 15.9075 75.498 15.1098C75.498 14.3121 75.7113 13.5289 76.1158 12.8413C76.5244 12.1916 77.0983 11.6622 77.7788 11.3073C78.4876 10.9344 79.278 10.7436 80.0788 10.7523C80.874 10.7425 81.6589 10.9334 82.3608 11.3073C83.0523 11.6735 83.6309 12.2211 84.0344 12.8915C84.4379 13.5618 84.6512 14.3294 84.6512 15.1118C84.6512 15.8942 84.4379 16.6619 84.0344 17.3322C83.6309 18.0025 83.0523 18.5502 82.3608 18.9163C81.6534 19.2827 80.8664 19.4689 80.0698 19.4583L80.0608 19.4573ZM80.0608 16.6943C80.3324 16.6989 80.5997 16.6264 80.8318 16.4853C81.0557 16.3471 81.2367 16.1494 81.3548 15.9143C81.4814 15.6573 81.5448 15.3738 81.5398 15.0873C81.5456 14.803 81.4821 14.5216 81.3548 14.2673C81.2295 14.0313 81.0422 13.8339 80.8132 13.6962C80.5842 13.5585 80.322 13.4858 80.0548 13.4858C79.7876 13.4858 79.5254 13.5585 79.2964 13.6962C79.0674 13.8339 78.8802 14.0313 78.7548 14.2673C78.6224 14.52 78.5564 14.8021 78.5628 15.0873C78.5576 15.3746 78.6235 15.6587 78.7548 15.9143C78.8771 16.149 79.0606 16.3463 79.2858 16.4853C79.5181 16.6258 79.7854 16.6976 80.0568 16.6923L80.0608 16.6943Z" fill="#1C134F"/><path d="M90.3741 19.4734C89.5364 19.4905 88.7078 19.2973 87.9641 18.9114C87.284 18.5522 86.7211 18.0056 86.3421 17.3364C85.943 16.6082 85.7432 15.7875 85.7631 14.9574V7.52539L88.8491 9.20439V11.5924H88.9491C89.108 11.4018 89.298 11.2396 89.5111 11.1124C89.7303 10.9816 89.969 10.8864 90.2181 10.8304C90.4872 10.7702 90.7623 10.7406 91.0381 10.7424C91.7438 10.7332 92.4386 10.9164 93.0481 11.2724C93.6479 11.6262 94.1397 12.1373 94.4701 12.7504C94.8317 13.4381 95.0117 14.2067 94.9931 14.9834C95.0011 15.6039 94.8894 16.2202 94.6641 16.7984C94.4525 17.3362 94.1299 17.8234 93.7172 18.228C93.3045 18.6326 92.811 18.9456 92.2691 19.1464C91.6641 19.3704 91.0232 19.4816 90.3781 19.4744L90.3741 19.4734ZM90.3741 16.7734C90.6432 16.7785 90.9081 16.706 91.1371 16.5644C91.3604 16.4209 91.5388 16.2175 91.6521 15.9774C91.779 15.7091 91.8423 15.4151 91.8371 15.1184C91.8431 14.8341 91.7796 14.5526 91.6521 14.2984C91.5334 14.0689 91.3556 13.8752 91.1371 13.7374C90.9073 13.6012 90.6452 13.5293 90.3781 13.5293C90.111 13.5293 89.8488 13.6012 89.6191 13.7374C89.3965 13.8728 89.2156 14.0669 89.0961 14.2984C88.9683 14.5525 88.9048 14.834 88.9111 15.1184C88.9058 15.4151 88.9691 15.7091 89.0961 15.9774C89.209 16.2198 89.3896 16.4243 89.6162 16.5663C89.8429 16.7082 90.1057 16.7815 90.3731 16.7774L90.3741 16.7734Z" fill="#1C134F"/><path d="M96.1657 19.268V13.532C96.1473 13.1882 96.1991 12.8442 96.3179 12.521C96.4367 12.1978 96.62 11.9021 96.8567 11.652C97.1147 11.4122 97.4187 11.2273 97.7503 11.1085C98.0819 10.9897 98.4341 10.9395 98.7857 10.961H101.455V13.298H99.8637C99.7877 13.2938 99.7117 13.3047 99.6399 13.3299C99.5681 13.3551 99.502 13.3943 99.4453 13.4451C99.3887 13.4959 99.3426 13.5574 99.3097 13.626C99.2768 13.6946 99.2578 13.769 99.2537 13.845C99.2526 13.8663 99.2526 13.8877 99.2537 13.909V19.277L96.1657 19.268Z" fill="#1C134F"/><path d="M107.025 19.262C106.17 19.2781 105.321 19.1146 104.533 18.782C103.836 18.4859 103.237 17.9984 102.805 17.376C102.366 16.7069 102.145 15.9187 102.17 15.119C102.138 14.2662 102.356 13.4226 102.797 12.692C103.196 12.0662 103.761 11.563 104.428 11.238C105.083 10.9112 105.804 10.7401 106.536 10.738C107.248 10.7263 107.951 10.8891 108.585 11.212C109.184 11.5218 109.684 11.992 110.031 12.57C110.405 13.2135 110.591 13.9483 110.57 14.692C110.57 14.892 110.559 15.128 110.538 15.392C110.521 15.6165 110.488 15.8394 110.438 16.059H105.328C105.365 16.2308 105.448 16.3893 105.569 16.517C105.701 16.6491 105.867 16.7416 106.049 16.784C106.275 16.8403 106.507 16.8675 106.74 16.865H110.44L110.564 19.26L107.025 19.262ZM105.193 14.362H107.732C107.732 14.2357 107.716 14.11 107.683 13.988C107.651 13.8702 107.599 13.7586 107.53 13.658C107.461 13.5559 107.377 13.464 107.282 13.385C107.18 13.3018 107.062 13.239 106.936 13.2C106.793 13.1556 106.645 13.1337 106.495 13.135C106.311 13.1325 106.127 13.1665 105.956 13.235C105.809 13.2937 105.675 13.381 105.562 13.492C105.454 13.6018 105.369 13.7329 105.314 13.877C105.254 14.0346 105.214 14.1993 105.196 14.367L105.193 14.362Z" fill="#1C134F"/><path d="M111.31 11.245C110.976 11.2448 110.65 11.1457 110.373 10.9601C110.095 10.7746 109.879 10.5109 109.751 10.2025C109.624 9.89413 109.59 9.55481 109.656 9.22746C109.721 8.90011 109.881 8.59943 110.117 8.36342C110.353 8.12741 110.654 7.96667 110.981 7.9015C111.309 7.83634 111.648 7.86968 111.957 7.99732C112.265 8.12496 112.529 8.34116 112.714 8.61859C112.9 8.89603 112.999 9.22225 112.999 9.55602C112.999 9.77786 112.956 9.99755 112.871 10.2025C112.786 10.4075 112.662 10.5938 112.505 10.7506C112.348 10.9075 112.162 11.0319 111.957 11.1167C111.752 11.2016 111.532 11.2452 111.31 11.245ZM111.31 8.02702C111.007 8.02682 110.711 8.11644 110.459 8.28455C110.207 8.45266 110.011 8.6917 109.895 8.97144C109.779 9.25117 109.748 9.55904 109.807 9.85609C109.866 10.1531 110.012 10.426 110.226 10.6402C110.44 10.8545 110.713 11.0004 111.01 11.0595C111.307 11.1187 111.615 11.0884 111.895 10.9726C112.175 10.8567 112.414 10.6605 112.582 10.4087C112.75 10.1569 112.84 9.86087 112.84 9.55802C112.84 9.35688 112.801 9.15766 112.724 8.97175C112.647 8.78583 112.535 8.61686 112.393 8.4745C112.251 8.33213 112.082 8.21916 111.896 8.14204C111.71 8.06491 111.511 8.02515 111.31 8.02502V8.02702Z" fill="#1C134F"/><path d="M110.593 10.419V8.53602H111.454C111.575 8.53435 111.695 8.56287 111.803 8.61902C111.905 8.67305 111.99 8.75311 112.051 8.85102C112.114 8.95348 112.146 9.07181 112.144 9.19202C112.145 9.30543 112.116 9.41713 112.059 9.51502C112.003 9.60958 111.926 9.68946 111.833 9.74802L111.983 10.004C111.991 10.016 112.002 10.0262 112.014 10.034C112.028 10.042 112.045 10.0458 112.062 10.045H112.228V10.419H111.965C111.89 10.419 111.816 10.3997 111.75 10.3629C111.685 10.3262 111.63 10.2732 111.591 10.209L111.391 9.85202H111.049V10.42L110.593 10.419ZM111.045 9.47702H111.404C111.454 9.47725 111.504 9.4656 111.549 9.44302C111.593 9.42086 111.631 9.3861 111.656 9.34302C111.683 9.29671 111.696 9.24367 111.695 9.19002C111.697 9.13905 111.684 9.08861 111.658 9.04466C111.632 9.00072 111.594 8.9651 111.549 8.94202C111.504 8.91912 111.455 8.90744 111.405 8.90802H111.046L111.045 9.47702Z" fill="#1C134F"/><path d="M13.987 2.336C11.6828 2.336 9.43034 3.01928 7.51448 4.29945C5.59863 5.57961 4.10542 7.39915 3.22369 9.52797C2.34196 11.6568 2.11131 13.9993 2.5609 16.2592C3.0105 18.5191 4.12016 20.5949 5.74954 22.2241C7.37892 23.8534 9.45485 24.9629 11.7148 25.4123C13.9747 25.8617 16.3172 25.6308 18.4459 24.7489C20.5747 23.867 22.3941 22.3736 23.6741 20.4577C24.9541 18.5417 25.6372 16.2892 25.637 13.985C25.6367 10.8954 24.4092 7.93243 22.2244 5.74785C20.0396 3.56327 17.0766 2.336 13.987 2.336ZM21.993 17.084C21.4911 17.9795 20.7465 18.715 19.845 19.206C18.8393 19.7397 17.7131 20.0053 16.575 19.977H11.592L13.165 17.084H16.365C16.8472 17.0927 17.3221 16.9652 17.735 16.716C18.1454 16.4587 18.4726 16.0881 18.677 15.649C18.9162 15.1287 19.0332 14.5605 19.019 13.988C19.0345 13.4174 18.9178 12.851 18.678 12.333C18.4701 11.8962 18.1437 11.5265 17.736 11.266C17.3246 11.0125 16.8491 10.8827 16.366 10.892H15.188L11.488 10.915H10.248C10.132 10.9022 10.0146 10.9148 9.90407 10.9521C9.79351 10.9895 9.69245 11.0505 9.60798 11.131C9.52904 11.2093 9.46701 11.3029 9.42572 11.4061C9.38444 11.5093 9.36479 11.6199 9.36798 11.731V13.049H15.358L13.832 15.874H9.36498V19.984H8.71798C8.31745 19.984 7.92084 19.9051 7.5508 19.7518C7.18075 19.5986 6.84452 19.3739 6.5613 19.0907C6.27809 18.8075 6.05342 18.4712 5.90015 18.1012C5.74687 17.7311 5.66798 17.3345 5.66798 16.934V11.658C5.6582 10.9974 5.83609 10.3475 6.18098 9.784C6.52533 9.22834 7.01311 8.7758 7.59298 8.474C8.22425 8.14677 8.92704 7.98181 9.63798 7.994H16.572C17.71 7.96568 18.8362 8.23086 19.842 8.764C20.7435 9.25597 21.4877 9.99258 21.989 10.889C22.4901 11.8455 22.7519 12.9092 22.7519 13.989C22.7519 15.0688 22.4901 16.1325 21.989 17.089L21.993 17.084Z" fill="#1C134F"/><path d="M13.987 27.974C11.2206 27.974 8.5164 27.1537 6.21625 25.6168C3.9161 24.0799 2.12335 21.8954 1.0647 19.3396C0.00606024 16.7838 -0.270929 13.9715 0.268763 11.2583C0.808454 8.54507 2.14059 6.05282 4.0967 4.0967C6.05282 2.14059 8.54507 0.808454 11.2583 0.268763C13.9715 -0.270929 16.7838 0.00606024 19.3396 1.0647C21.8954 2.12335 24.0799 3.9161 25.6168 6.21625C27.1537 8.5164 27.974 11.2206 27.974 13.987C27.974 15.8238 27.6122 17.6426 26.9093 19.3396C26.2064 21.0366 25.1761 22.5785 23.8773 23.8773C22.5785 25.1761 21.0366 26.2064 19.3396 26.9093C17.6426 27.6122 15.8238 27.974 13.987 27.974ZM13.987 0.559006C11.3311 0.558809 8.73481 1.3462 6.52643 2.82162C4.31806 4.29703 2.5968 6.39418 1.58034 8.84787C0.563886 11.3016 0.297882 14.0016 0.815973 16.6064C1.33406 19.2113 2.61298 21.604 4.49098 23.482C6.36898 25.36 8.76171 26.6389 11.3666 27.157C13.9714 27.6751 16.6715 27.4091 19.1251 26.3927C21.5788 25.3762 23.676 23.655 25.1514 21.4466C26.6268 19.2382 27.4142 16.6419 27.414 13.986C27.41 10.4261 25.9942 7.01306 23.477 4.49571C20.9598 1.97836 17.5469 0.563241 13.987 0.559006Z" fill="#1C134F"/></svg>'
};
    
    
const NAV_ICONS = {
    settings: '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-settings-icon lucide-settings"><path d="M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915"/><circle cx="12" cy="12" r="3"/></svg>',
    docs: '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-file-text-icon lucide-file-text"><path d="M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z"/><path d="M14 2v4a2 2 0 0 0 2 2h4"/><path d="M10 9H8"/><path d="M16 13H8"/><path d="M16 17H8"/></svg>',
    search: '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-search-icon lucide-search"><path d="m21 21-4.34-4.34"/><circle cx="11" cy="11" r="8"/></svg>',
};

export function renderHeader(state) {
    const settingsActive = state.view === APP_VIEWS.SETTINGS ? ' is-active' : '';
    const html = `
        <header class="dm-topbar">
            <button type="button" class="dm-topbar__brand" data-dm-nav="maps" aria-label="Developer Map" title="Developer Map">
                <div class="dm-topbar__brand-text">
                    <span class="dm-topbar__title">Developer Map</span>
                    <span class="dm-topbar__version">Version ${PLUGIN_VERSION}</span>
                </div>
                <span class="dm-topbar__mark" aria-hidden="true">${BRAND_ICONS.mark}</span>
                <span class="dm-topbar__sr">Developer Map by FuuDobre</span>
            </button>
            <div class="dm-topbar__search">
                <span class="dm-topbar__search-icon" aria-hidden="true">${NAV_ICONS.search}</span>
                <input type="search" placeholder="Vyhľadať mapu..." aria-label="Vyhľadať mapu" data-dm-role="search" data-dm-preserve-focus="topbar-search" value="${escapeHtml(state.searchTerm)}" />
            </div>
            <nav class="dm-topbar__nav">
                <button type="button" class="dm-topbar__link${settingsActive}" data-dm-nav="settings">
                    <span class="dm-topbar__link-icon" aria-hidden="true">${NAV_ICONS.settings}</span>
                    <span>Nastavenia</span>
                </button>
                <button type="button" class="dm-topbar__link" disabled>
                    <span class="dm-topbar__link-icon" aria-hidden="true">${NAV_ICONS.docs}</span>
                    <span>Dokumentácia</span>
                </button>
            </nav>
        </header>
    `;
    return html;
}
